#!/usr/bin/env perl
use strict;
use warnings;
use Pod::Usage;
use FindBin;                      # Find the location of seq-manipulations
use v5.10;
use rlib '../lib';
use Getopt::Long qw( :config bundling permute no_getopt_compat );
use Bio::BPWrapper;
use Bio::BPWrapper::PopManipulations;

################# Option parsing #################
my %opts;
my %flags;
GetOptions(
    \%opts,
    "help|h",
    "man",
#    "distance|d",
#    "dist-method|D=s" => \$flags{"dist-method"},
    "bihaps",
    "bisites",
    "bisites-for-r",
    "heterozygosity|H",
    "input|i=s" => \$flags{"input"},
    "mismatch|m",
    "mut-info",
#    "numseq|n=i"    => \$flags{"numseq"},
    "pi|p",
    "stats|s=s@",    # Comma-separated, or multiply specified, list
    "snp",
    "snp-coding",
    "snp-coding-long",
    "snp-noncoding",
    "version|V",
    "segsites|S",
    "bipart",
#    "mutrec|b",
#    "exclude|group3|seq3|r=s@",
#    "ingroup|group1|seq1|p=s@",
#    "simmk|k",
#    "outgroup|group2|seq2|q=s@",
#    "kaks=s",
) or pod2usage(2);

use constant PROGRAM => File::Basename::basename(__FILE__);
Bio::BPWrapper::print_version(PROGRAM) if $opts{"version"};

# This sets all internal variables, and loads AlignIO objects
initialize(\%opts, \%flags);
write_out(\%opts)

################# POD Documentation ##################

__END__

=encoding utf8

=head1 NAME

biopop - Wrapper script for L<Bio::Perl>'s population genetics modules


=head1 SYNOPSIS

B<biopop> I<options> [I<alignment_file>]

B<biopop> C<-h> | C<--help>

B<biopop> C<-v> | C<--version>

B<biopop> C<--man>

=head1 DESCRIPTION

Wrapper script for L<Bio::Perl>'s population genetics modules: use L<Bio::PopGen::Utilities>;
L<Bio::PopGen::Statistics>, and L<Bio::PopGen::Population>;

=head1 OPTIONS

=head2 --help, -h

Print a brief help message and exits.

=head2 --distance, -d

Calculates a distance matrix for all pairwise distances of all sequences in the input alignment and prints it out.

Use B<--dist-method> to specify the method desired. The default in Bio::Align::DNAStatistics is "JukesCantor".

=head2 --dist-method, -D

Used with --distance to specify which distance method to use when getting the distance matrix.

Program quits if the distance method is invalid

=head2 --heterozygosity, -H

Foreach segregating site(s), the observed heterozygosity is returned.

=head2 --input, -i

Input file format. By default, this is 'clustalw'.

=head2 --mismatch, -m

Pairwise calculation of mismatches for all sequences in the alignment.

=head2 --numseq, -n

Input file format. By default, this is 'clustalw'.

=head2 --pi, -p

Nucleotide Diversity is a measure of genetic variation or differences. It is similar to expected heterozygosity. This method takes in an alignment and outputs an integer.

=head2 --stats, -s <comma separated list of values>

Specify the statistics you would like to gather from input data. e.g., "theta,pi" will calculate the theta and pi values.

Can also be specified by giving the option multiple times. e.g.,
 biopop --stats=pi --stats=theta

=head2 --snp_coding

Identify & print, for each 2-state SNP, codon position, aligned nucleotide position, syn/nonsyn, frequencies of each allleic state, for a coding alignment.

=head2 --varsites, -v

This method outputs the number of segregating or SNP sites within your alignment.

=head2 --version, -V

Print current release version of bp-utils.

Usage: bioseq -V

=head1 REQUIRES

Perl 5.010, BioPerl

=head1 SEE ALSO

  perl(1)

=head1 AUTHORS

 Weigang Qiu at genectr.hunter.cuny.edu
 Yözen Hernández yzhernand at gmail dot com

=cut
